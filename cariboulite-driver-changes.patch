diff --git a/driver/CMakeLists.txt b/driver/CMakeLists.txt
index c5ff72f..a76bea1 100644
--- a/driver/CMakeLists.txt
+++ b/driver/CMakeLists.txt
@@ -25,6 +25,20 @@ find_path(
 message(STATUS "Kernel release: ${KERNEL_RELEASE}")
 message(STATUS "Kernel headers: ${KERNELHEADERS_DIR}")
 
+# Check kernel version for class_create API change (changed in 6.4)
+string(REGEX MATCH "^([0-9]+)\\.([0-9]+)" KERNEL_VERSION_MATCH ${KERNEL_RELEASE})
+set(KERNEL_MAJOR ${CMAKE_MATCH_1})
+set(KERNEL_MINOR ${CMAKE_MATCH_2})
+
+# Kernel 6.4+ uses class_create without owner parameter
+if((KERNEL_MAJOR GREATER 6) OR ((KERNEL_MAJOR EQUAL 6) AND (KERNEL_MINOR GREATER_EQUAL 4)))
+    set(HAVE_CLASS_WITHOUT_OWNER 1)
+else()
+    set(HAVE_CLASS_WITHOUT_OWNER 0)
+endif()
+
+message(STATUS "HAVE_CLASS_WITHOUT_OWNER: ${HAVE_CLASS_WITHOUT_OWNER}")
+
 function(compile_module obj)
     set(TARGET_NAME ${obj})
     add_custom_target(${TARGET_NAME} ALL cp -f ${CMAKE_CURRENT_SOURCE_DIR}/*.c ${CMAKE_CURRENT_SOURCE_DIR}/*.h ${CMAKE_CURRENT_BINARY_DIR}/
@@ -45,7 +59,7 @@ function(compile_module obj)
         #COMMAND echo "MY_CFLAGS += -g -DDEBUG" >> ${CMAKE_CURRENT_BINARY_DIR}/Makefile
         #COMMAND echo "ccflags-y += -g -DDEBUG" >> ${CMAKE_CURRENT_BINARY_DIR}/Makefile
         #COMMAND echo "CC += -g -DDEBUG" >> ${CMAKE_CURRENT_BINARY_DIR}/Makefile
-        COMMAND echo "ccflags-y += -O2 -DMODULE -D__KERNEL__" >> ${CMAKE_CURRENT_BINARY_DIR}/Makefile
+        COMMAND echo "ccflags-y += -O2 -DMODULE -D__KERNEL__ -DHAVE_CLASS_WITHOUT_OWNER=${HAVE_CLASS_WITHOUT_OWNER}" >> ${CMAKE_CURRENT_BINARY_DIR}/Makefile
         COMMAND echo "${obj}-objs:=${depend_objlist}" >> ${CMAKE_CURRENT_BINARY_DIR}/Makefile
         #COMMAND make -C ${KERNELHEADERS_DIR} M=${CMAKE_CURRENT_BINARY_DIR} modules EXTRA_CFLAGS="-g"
         COMMAND make -C ${KERNELHEADERS_DIR} M=${CMAKE_CURRENT_BINARY_DIR} modules
diff --git a/driver/smi_stream_dev.c b/driver/smi_stream_dev.c
index e0d6618..78b9369 100644
--- a/driver/smi_stream_dev.c
+++ b/driver/smi_stream_dev.c
@@ -62,6 +62,7 @@
 #include <linux/wait.h>
 #include <linux/poll.h>
 #include <linux/init.h>
+#include <linux/vmalloc.h>
 
 #include "smi_stream_dev.h"
 
@@ -1050,7 +1051,12 @@ static int smi_stream_dev_probe(struct platform_device *pdev)
     }
 
     // Create sysfs entries with "smi-stream-dev"
+#if defined(HAVE_CLASS_WITHOUT_OWNER) && HAVE_CLASS_WITHOUT_OWNER
+    smi_stream_class = class_create(DEVICE_NAME);
+#else
     smi_stream_class = class_create(THIS_MODULE, DEVICE_NAME);
+#endif
+
     ptr_err = smi_stream_class;
     if (IS_ERR(ptr_err))
     {
@@ -1102,20 +1108,25 @@ static int smi_stream_dev_probe(struct platform_device *pdev)
 *
 ***************************************************************************/
 
+#if LINUX_VERSION_CODE >= KERNEL_VERSION(6, 11, 0)
+static void smi_stream_dev_remove(struct platform_device *pdev)
+#else
 static int smi_stream_dev_remove(struct platform_device *pdev)
+#endif
 {
     //if (inst->reader_thread != NULL) kthread_stop(inst->reader_thread);
-    //inst->reader_thread = NULL;	
-    
+    //inst->reader_thread = NULL;
+
     device_destroy(smi_stream_class, smi_stream_devid);
     class_destroy(smi_stream_class);
     cdev_del(&smi_stream_cdev);
     unregister_chrdev_region(smi_stream_devid, 1);
 
     dev_info(inst->dev, DRIVER_NAME": smi-stream dev removed");
+#if LINUX_VERSION_CODE < KERNEL_VERSION(6, 11, 0)
     return 0;
-}
-
+#endif
+}   
 /****************************************************************************
 *
 *   Register the driver with device tree
diff --git a/driver/smi_stream_dev.h b/driver/smi_stream_dev.h
index 268302c..01b86d2 100644
--- a/driver/smi_stream_dev.h
+++ b/driver/smi_stream_dev.h
@@ -38,6 +38,7 @@
 #define _SMI_STREAM_DEV_H_
 
 #include <linux/ioctl.h>
+#include <linux/version.h>
 
 #ifndef __KERNEL__
 	#include <stdint.h>
